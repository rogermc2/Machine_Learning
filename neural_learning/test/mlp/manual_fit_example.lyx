#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 15mm
\topmargin 10mm
\rightmargin 10mm
\bottommargin 15mm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
Manually worked out example
\end_layout

\begin_layout Section
Declarations
\end_layout

\begin_layout Standard
\begin_inset Formula $X=\begin{bmatrix}\begin{bmatrix}0.6 & 0.8 & 0.7\end{bmatrix}\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $Y=\begin{bmatrix}0.0\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
Layer 1 parameters
\end_layout

\begin_layout Standard
\begin_inset Formula $W=coefs0=\begin{bmatrix}0.1 & 0.2\\
0.3 & 0.1\\
0.5 & 0.0
\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $b1=intercepts0=\begin{bmatrix}0.1 & 0.1\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
Layer 2 parameters
\end_layout

\begin_layout Standard
\begin_inset Formula $W2=mlp.coefs1=\begin{bmatrix}0.1\\
0.2
\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $b2=intercepts1=\begin{bmatrix}1.0\end{bmatrix}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $g$
\end_inset

 represents an activation function
\end_layout

\begin_layout Standard
\begin_inset Formula $i$
\end_inset

 represents matrix row number
\end_layout

\begin_layout Standard
\begin_inset Formula $h_{k}$
\end_inset

 represents output (activation) 
\begin_inset Formula $k$
\end_inset

 of layer 1
\end_layout

\begin_layout Standard
\begin_inset Formula $h=\begin{bmatrix}h_{1} & h_{2}\end{bmatrix}$
\end_inset

 represents layer 1 output 
\end_layout

\begin_layout Standard
\begin_inset Formula $o1$
\end_inset

 represents layer 2 output
\end_layout

\begin_layout Section
Forward Pass
\end_layout

\begin_layout Standard
Layer 1:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
X1 & = & X\left(1\right)=\begin{bmatrix}0.6 & 0.8 & 0.7\end{bmatrix}\\
X2 & = & X1
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $h=\left[h_{1},h_{2}\right]$
\end_inset

 represents the output of activity function 
\begin_inset Formula $g$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
h_{1} & = & g(X1*W_{i,1}+b1_{1})\\
 & = & g(0.6*0.1+0.8*0.3+0.7*0.5+0.1)\\
 & = & 0.679178699175393
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
h_{2} & = & g(X2*W_{i,2}+b1_{2})\\
 & = & g(0.6*0.2+0.8*0.1+0.7*0+0.1)\\
 & = & 0.574442516811659
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
h & = & \begin{bmatrix}h_{1} & h_{2}\end{bmatrix}=\begin{bmatrix}0.679 & 0.574\end{bmatrix}
\end{eqnarray*}

\end_inset

Layer 2:
\begin_inset Formula 
\begin{eqnarray*}
h & = & \begin{bmatrix}h_{1} & h_{2}\end{bmatrix}=\begin{bmatrix}0.679 & 0.574\end{bmatrix}\,\,\,\,\,\,\,input\\
o1 & = & g(h*W2+b2_{1})\,\,\,\,\,\,\,output\\
 & = & g(0.679*0.1+0.574*0.2+1)\\
 & = & 0.7654329236196236
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Section
Back Propogation
\end_layout

\begin_layout Standard
\begin_inset Formula $di$
\end_inset

 represents delta (error) for layer 
\begin_inset Formula $i$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
d21 & = & o1-Y\\
 & = & -\left(Y-o1\right)\\
 & = & -(0-0.765)=0.765
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
According to backprop line 313 of _multilater_perceptron
\begin_inset Formula 
\begin{eqnarray*}
d_{i-1} & = & LogDeriv\left(d_{i}*h^{T}\right)\\
d_{1} & = & \left(d_{2}*\begin{bmatrix}h_{1}\\
h_{2}
\end{bmatrix}\right)o1*\left(1-o1\right)\\
d_{1i} & = & \left(d_{2}*h_{i}\right)o1*\left(1-o1\right)
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
d11 & = & (1-h1)*h1*o1*W2_{1}\\
 & = & (1-0.679)*0.679*0.765*0.1=0.01667\\
d12 & = & (1-h2)*h2*o1*W2_{2}\\
 & = & (1-0.574)*0.574*0.765*0.2=0.0374
\end{eqnarray*}

\end_inset

 Compute loss gradients? _compute_loss_grad line 185 of _multilater_perceptron
\begin_inset Formula 
\begin{eqnarray*}
W_{i} & = & \left(X_{i}^{T}\cdot d_{i}+\alpha*self.W_{i}\right)/numSamples\\
b_{i} & = & Mean\left(d_{i}\right)
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
W1grad11 & = & X1*d11+\alpha*W11\\
 & = & 0.6*0.01667+0.1*0.1\\
 & = & 0.0200\\
W1grad11 & = & X1*d12+\alpha*W12\\
 & = & 0.6*0.0374+0.1*0.2\\
 & = & 0.04244
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
W1grad21 & = & X2*d11+\alpha*W13\\
 & = & 0.8*0.01667+0.1*0.3\\
 & = & 0.043336\\
W1grad22 & = & X2*d12+\alpha*W14\\
 & = & 0.8*0.0374+0.1*0.1\\
 & = & 0.03992
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
W1grad31 & = & X3*d11+\alpha*W15\\
 & = & 0.6*0.01667+0.1*0.5\\
 & = & 0.060002\\
W1grad32 & = & X3*d12+\alpha*W16\\
 & = & 0.6*0.0374+0.1*0\\
 & = & 0.02244
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
W2grad1 & = & h1*d21+\alpha*W21\\
 & = & 0.679*0.765+0.1*0.1\\
 & = & 0.5294\\
W2grad2 & = & h2*d21+\alpha*W22\\
 & = & 0.574*0.765+0.1*0.2\\
 & = & 0.45911
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
b1grad1 & = & d11=0.01667\\
b1grad2 & = & d12=0.0374\\
b2grad & = & d21=0.765
\end{eqnarray*}

\end_inset

 
\begin_inset Formula 
\begin{eqnarray*}
W1 & = & W1-eta*[W1grad11,..,W1grad32]\\
 & = & \begin{bmatrix}0.1 & 0.2\\
0.3 & 0.1\\
0.5 & 0.0
\end{bmatrix}-0.1\begin{bmatrix}0.0200 & 0.04244\\
0.043336 & 0.03992\\
0.060002, & 0.02244
\end{bmatrix}\\
 & = & \begin{bmatrix}0.098 & 0.195756\\
0.2956664 & 0.096008\\
0.4939998 & -0.002244
\end{bmatrix}
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
W2 & = & W1-eta*[W2grad1,..,W2grad2]\\
 & = & \begin{bmatrix}0.1\\
0.2
\end{bmatrix}-0.1\begin{bmatrix}0.5294\\
0.45911
\end{bmatrix}\\
 & = & \begin{bmatrix}0.04706\\
0.154089
\end{bmatrix}
\end{eqnarray*}

\end_inset


\begin_inset Formula 
\begin{eqnarray*}
b1 & = & b1-eta*[b1grad1,b1grad2]\\
 & = & 0.1-0.1*[0.01667,0.0374]\\
 & = & [0.098333,0.09626]\\
b2 & = & b2-eta*b2grad\\
 & = & 1.0-0.1*0.765\\
 & = & 0.9235
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Section
Assertions
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
coeffs_{1} & \equiv & W1\\
intercepts_{1} & \equiv & b1\\
coeffs_{2} & \equiv & W2\\
intercepts_{2} & \equiv & b2
\end{eqnarray*}

\end_inset


\end_layout

\end_body
\end_document

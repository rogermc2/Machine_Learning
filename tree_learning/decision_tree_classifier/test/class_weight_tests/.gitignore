test_weight_functions